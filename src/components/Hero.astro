---
// Hero section with modern 2025-2026 design trends
import ThemeToggle from './ThemeToggle.astro';
import LanguageSwitcher from './LanguageSwitcher.astro';
import VideoModal from './VideoModal.astro';
import { getTranslation } from '../lib/i18n';

// Helper function to get translation with dynamic values
const t = (key: string, values: Record<string, string> = {}) => {
  let translation = getTranslation(Astro, key);

  // Replace dynamic values in translations
  Object.entries(values).forEach(([placeholder, value]) => {
    translation = translation.replace(`{${placeholder}}`, value);
  });

  return translation;
};
---

<!-- Hero Section with Dark/Light Theme Support -->
<section class="hero min-h-screen relative overflow-hidden theme-transition" data-theme-toggle>
  <div class="h-screen flex items-center justify-center">
  <!-- Background with gradient effects -->
  <div class="hero-background absolute inset-0">
    <div class="absolute inset-0 bg-gradient-to-br from-primary/10 via-transparent to-secondary/10"></div>
    <div class="absolute inset-0 bg-gradient-to-t from-base-100/50 to-transparent"></div>
  </div>

  <!-- Navigation -->
  <nav class="navbar bg-base-100/80 backdrop-blur-md absolute top-0 left-0 right-0 z-40 border-b border-base-content/10 theme-transition">
    <div class="container mx-auto px-4 py-4">
      <div class="flex justify-between items-center">
        <!-- Logo -->
        <div class="flex items-center space-x-2">
          <div class="w-10 h-10 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center">
            <span class="text-primary-content font-bold text-xl">J</span>
          </div>
          <span class="text-xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">Joga</span>
        </div>

        <!-- Mobile menu button -->
        <div class="lg:hidden flex items-center gap-2">
          <LanguageSwitcher />
          <ThemeToggle />
          <button class="btn btn-ghost btn-circle" onclick="toggleMobileMenu()">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>

        <!-- Desktop Navigation -->
        <div class="hidden lg:flex items-center space-x-8">
          <a href="#classes" class="link link-hover text-base-content/80 hover:text-primary transition-colors">{t('nav.classes')}</a>
          <a href="#features" class="link link-hover text-base-content/80 hover:text-primary transition-colors">{t('nav.features')}</a>
          <a href="#pricing" class="link link-hover text-base-content/80 hover:text-primary transition-colors">{t('nav.pricing')}</a>
          <a href="#testimonials" class="link link-hover text-base-content/80 hover:text-primary transition-colors">{t('nav.testimonials')}</a>
          <div class="flex items-center gap-2">
            <LanguageSwitcher />
            <ThemeToggle />
            <a href="/sign-up/" class="btn btn-primary">{t('nav.getStarted')}</a>
          </div>
        </div>
      </div>

      <!-- Mobile Menu -->
      <div id="mobile-menu" class="hidden lg:hidden mt-4 pb-4">
        <div class="flex flex-col space-y-3">
          <a href="#classes" class="link link-hover text-base-content/80">{t('nav.classes')}</a>
          <a href="#features" class="link link-hover text-base-content/80">{t('nav.features')}</a>
          <a href="#pricing" class="link link-hover text-base-content/80">{t('nav.pricing')}</a>
          <a href="#testimonials" class="link link-hover text-base-content/80">{t('nav.testimonials')}</a>
          <a href="/sign-up/" class="btn btn-primary w-full">{t('nav.getStarted')}</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Scroll Progress Indicator -->
  <div class="fixed top-0 left-0 w-full h-1 bg-base-200 z-50">
    <div id="scroll-progress" class="h-full bg-gradient-to-r from-primary to-secondary transition-all duration-300" style="width: 0%"></div>
  </div>

  <!-- Side Navigation Dots -->
  <div class="fixed right-6 top-1/2 transform -translate-y-1/2 z-40 hidden lg:block">
    <div class="flex flex-col gap-4">
      <a href="#hero" class="nav-dot w-3 h-3 bg-base-300 rounded-full transition-all duration-300 hover:bg-primary hover:scale-150" data-section="hero" title="Home">
        <span class="absolute right-6 top-1/2 transform -translate-y-1/2 bg-base-100 text-base-content px-2 py-1 rounded text-xs opacity-0 hover:opacity-100 transition-opacity whitespace-nowrap">Home</span>
      </a>
      <a href="#features" class="nav-dot w-3 h-3 bg-base-300 rounded-full transition-all duration-300 hover:bg-primary hover:scale-150" data-section="features" title="Features">
        <span class="absolute right-6 top-1/2 transform -translate-y-1/2 bg-base-100 text-base-content px-2 py-1 rounded text-xs opacity-0 hover:opacity-100 transition-opacity whitespace-nowrap">Features</span>
      </a>
      <a href="#classes" class="nav-dot w-3 h-3 bg-base-300 rounded-full transition-all duration-300 hover:bg-primary hover:scale-150" data-section="classes" title="Classes">
        <span class="absolute right-6 top-1/2 transform -translate-y-1/2 bg-base-100 text-base-content px-2 py-1 rounded text-xs opacity-0 hover:opacity-100 transition-opacity whitespace-nowrap">Classes</span>
      </a>
      <a href="#testimonials" class="nav-dot w-3 h-3 bg-base-300 rounded-full transition-all duration-300 hover:bg-primary hover:scale-150" data-section="testimonials" title="Testimonials">
        <span class="absolute right-6 top-1/2 transform -translate-y-1/2 bg-base-100 text-base-content px-2 py-1 rounded text-xs opacity-0 hover:opacity-100 transition-opacity whitespace-nowrap">Testimonials</span>
      </a>
      <a href="#pricing" class="nav-dot w-3 h-3 bg-base-300 rounded-full transition-all duration-300 hover:bg-primary hover:scale-150" data-section="pricing" title="Pricing">
        <span class="absolute right-6 top-1/2 transform -translate-y-1/2 bg-base-100 text-base-content px-2 py-1 rounded text-xs opacity-0 hover:opacity-100 transition-opacity whitespace-nowrap">Pricing</span>
      </a>
      <a href="#cta" class="nav-dot w-3 h-3 bg-base-300 rounded-full transition-all duration-300 hover:bg-primary hover:scale-150" data-section="cta" title="Get Started">
        <span class="absolute right-6 top-1/2 transform -translate-y-1/2 bg-base-100 text-base-content px-2 py-1 rounded text-xs opacity-0 hover:opacity-100 transition-opacity whitespace-nowrap">Get Started</span>
      </a>
    </div>
  </div>

  <!-- Scroll Indicator Arrow -->
  <div class="scroll-indicator absolute bottom-8 left-1/2 transform -translate-x-1/2 text-base-content/60" onclick="scrollToNextSection()">
    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
    </svg>
  </div>

  <!-- Hero Content -->
  <div class="hero-content text-center px-4 pt-20 pb-10 relative z-10">
    <div class="max-w-4xl mx-auto">
      <!-- Badge -->
      <div class="badge badge-primary badge-outline mb-4">
        <span class="flex items-center gap-1">
          <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
          </svg>
          New: AI-Powered Personalization
        </span>
      </div>

      <!-- Main Headline -->
      <h1 class="text-4xl md:text-6xl lg:text-7xl font-bold mb-6 leading-tight">
        <span class="bg-gradient-to-r from-primary via-primary/80 to-secondary bg-clip-text text-transparent">
          {t('hero.title')}
        </span>
      </h1>

      <!-- Subheadline -->
      <p class="text-lg md:text-xl text-base-content/80 mb-8 max-w-2xl mx-auto leading-relaxed">
        {t('hero.description')}
      </p>

      <!-- CTA Buttons -->
      <div class="flex flex-col sm:flex-row gap-4 justify-center mb-12">
        <a href="/sign-up/" class="btn btn-primary btn-lg min-w-[200px]">
          {t('hero.ctaPrimary')}
          <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
          </svg>
        </a>
        <button class="btn btn-outline btn-lg min-w-[200px]" onclick="playIntroVideo()">
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          {t('hero.ctaSecondary')}
        </button>
      </div>

      <!-- Stats Section -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-8 max-w-3xl mx-auto">
        <div class="text-center">
          <div class="text-3xl font-bold text-primary mb-1">50K+</div>
          <div class="text-sm text-base-content/60">Active Members</div>
        </div>
        <div class="text-center">
          <div class="text-3xl font-bold text-secondary mb-1">1000+</div>
          <div class="text-sm text-base-content/60">Classes</div>
        </div>
        <div class="text-center">
          <div class="text-3xl font-bold text-accent mb-1">4.9</div>
          <div class="text-sm text-base-content/60">Rating</div>
        </div>
        <div class="text-center">
          <div class="text-3xl font-bold text-primary mb-1">24/7</div>
          <div class="text-sm text-base-content/60">Access</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Floating elements for visual interest -->
  <div class="absolute top-20 left-10 w-20 h-20 bg-primary/10 rounded-full blur-xl animate-pulse"></div>
  <div class="absolute bottom-20 right-10 w-32 h-32 bg-secondary/10 rounded-full blur-2xl animate-pulse delay-1000"></div>
  <div class="absolute top-1/2 left-1/4 w-16 h-16 bg-accent/10 rounded-full blur-lg animate-bounce delay-500"></div>
  </div>
</section>

<!-- Video Modal -->
<VideoModal />

<script>
  // Declare the function type on Window interface
  declare global {
    interface Window {
      toggleMobileMenu: () => void;
      scrollToNextSection: () => void;
    }
  }

  // Mobile menu functionality - make globally available
  window.toggleMobileMenu = function() {
    const menu = document.getElementById('mobile-menu');
    if (menu) {
      menu.classList.toggle('hidden');
    }
  };

  // Scroll to next section functionality
  window.scrollToNextSection = function() {
    const sections = document.querySelectorAll('section[id]');
    const currentScroll = window.scrollY;
    const windowHeight = window.innerHeight;

    for (let i = 0; i < sections.length; i++) {
      const section = sections[i];
      const rect = section.getBoundingClientRect();
      const sectionTop = rect.top + currentScroll;

      if (sectionTop > currentScroll + windowHeight * 0.5) {
        section.scrollIntoView({ behavior: 'smooth' });
        break;
      }
    }
  };

  // Video modal functionality is handled by the VideoModal component
  // The playIntroVideo function is already defined globally by VideoModal

  // Enhanced navigation and scroll functionality
  document.addEventListener('DOMContentLoaded', () => {
    const mobileLinks = document.querySelectorAll('#mobile-menu a');
    mobileLinks.forEach(link => {
      link.addEventListener('click', () => {
        const menu = document.getElementById('mobile-menu');
        if (menu) {
          menu.classList.add('hidden');
        }
      });
    });

    // Enhanced smooth scrolling for navigation links
    const navLinks = document.querySelectorAll('a[href^="#"]');
    navLinks.forEach(link => {
      link.addEventListener('click', function (e: Event) {
        e.preventDefault();
        const targetId = (e.currentTarget as HTMLAnchorElement).getAttribute('href')?.substring(1);
        const targetSection = targetId ? document.getElementById(targetId) : null;
        if (targetSection) {
          targetSection.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });

    // Scroll progress indicator
    const updateScrollProgress = () => {
      const scrollTop = window.scrollY;
      const docHeight = document.documentElement.scrollHeight - window.innerHeight;
      const scrollPercent = (scrollTop / docHeight) * 100;
      const progressBar = document.getElementById('scroll-progress');
      if (progressBar) {
        progressBar.style.width = scrollPercent + '%';
      }
    };

    // Update scroll progress on scroll
    window.addEventListener('scroll', updateScrollProgress);

    // Active section highlighting for navigation
    const sections = document.querySelectorAll('section[id]');
    const navLinksArray = Array.from(navLinks);
    const navDots = document.querySelectorAll('.nav-dot');

    const highlightActiveSection = () => {
      const scrollPosition = window.scrollY + window.innerHeight / 2;

      sections.forEach(section => {
        const sectionTop = (section as HTMLElement).offsetTop;
        const sectionHeight = (section as HTMLElement).offsetHeight;
        const sectionId = section.getAttribute('id');

        if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
          // Highlight main navigation links
          navLinksArray.forEach(link => {
            link.classList.remove('text-primary', 'font-semibold');
            link.classList.add('text-base-content/80');
          });

          const activeLink = navLinksArray.find(link =>
            link.getAttribute('href') === `#${sectionId}`
          );
          if (activeLink) {
            activeLink.classList.remove('text-base-content/80');
            activeLink.classList.add('text-primary', 'font-semibold');
          }

          // Highlight side navigation dots
          navDots.forEach(dot => {
            dot.classList.remove('bg-primary', 'scale-125');
            dot.classList.add('bg-base-300');
          });

          const activeDot = document.querySelector(`.nav-dot[data-section="${sectionId}"]`);
          if (activeDot) {
            activeDot.classList.remove('bg-base-300');
            activeDot.classList.add('bg-primary', 'scale-125');
          }
        }
      });
    };

    window.addEventListener('scroll', highlightActiveSection);

    // Smooth scrolling for side navigation dots
    navDots.forEach(dot => {
      dot.addEventListener('click', function (e: Event) {
        e.preventDefault();
        const targetId = (e.currentTarget as HTMLAnchorElement).getAttribute('href')?.substring(1);
        const targetSection = targetId ? document.getElementById(targetId) : null;
        if (targetSection) {
          targetSection.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });

    // Parallax effect for floating elements
    const floatingElements = document.querySelectorAll('[class*="animate-float"], [class*="animate-pulse"]');

    const updateParallax = () => {
      const scrolled = window.scrollY;
      floatingElements.forEach((element, index) => {
        const speed = 0.5 + (index * 0.1);
        const yPos = -(scrolled * speed);
        (element as HTMLElement).style.transform = `translateY(${yPos}px)`;
      });
    };

    window.addEventListener('scroll', updateParallax);

    // Show/hide scroll indicator based on scroll position
    const scrollIndicator = document.querySelector('.scroll-indicator');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 100) {
        scrollIndicator?.classList.add('opacity-0', 'pointer-events-none');
      } else {
        scrollIndicator?.classList.remove('opacity-0', 'pointer-events-none');
      }
    });
  });
</script>